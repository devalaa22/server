name: Ubuntu Desktop - Chrome RDP

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 9999

    steps:
      - name: Install XFCE Desktop & Chrome Remote Desktop
        run: |
          # ุชุญุฏูุซ ุงูุญุฒู ูุชุซุจูุช ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ
          sudo apt update
          sudo apt install -y xfce4 xfce4-goodies
          sudo apt install -y wget curl unzip nano

          # ุชุซุจูุช Google Chrome Remote Desktop
          wget https://dl.google.com/linux/direct/chrome-remote-desktop_current_amd64.deb
          sudo dpkg -i chrome-remote-desktop_current_amd64.deb || sudo apt -f install -y
          sudo apt install -f -y

          # ุฅุถุงูุฉ ูุฌููุนุฉ chrome-remote-desktop ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
          if ! getent group chrome-remote-desktop > /dev/null 2>&1; then
            sudo groupadd chrome-remote-desktop
          fi

          # ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ (ุงุฎุชูุงุฑู)
          sudo useradd -m githubuser
          echo 'githubuser:123456' | sudo chpasswd
          sudo usermod -aG sudo githubuser

          # ุฅุนุฏุงุฏ Chrome Remote Desktop ูุชุดุบูู XFCE
          sudo bash -c 'echo "exec /usr/sbin/lightdm-session startxfce4" > /etc/chrome-remote-desktop-session'

          # ุชุนุทูู ุฎุฏูุฉ LightDM
          sudo systemctl disable lightdm.service

          # ุฅุถุงูุฉ ุงููุณุชุฎุฏู ุฅูู ูุฌููุนุฉ chrome-remote-desktop
          sudo usermod -a -G chrome-remote-desktop githubuser

          # ุฅุนุงุฏุฉ ุชุดุบูู ุฎุฏูุฉ Chrome Remote Desktop
          sudo systemctl restart chrome-remote-desktop

          # ุฅุดุนุงุฑ ุจุชุซุจูุช ูู ุดูุก ุจูุฌุงุญ
          echo "โ ุชู ุชุซุจูุช ูู ุดูุก ุจูุฌุงุญุ ุงูุขู ุชุญุชุงุฌ ุฅูู ุงูุชูุฌู ุฅูู:"
          echo "๐ ุงูุชุญ ูุฐุง ุงูุฑุงุจุท ูุณุฌู ุฏุฎููู: https://remotedesktop.google.com/headless"
          echo "โช๏ธ ุงุฎุชูุฑ 'Debian Linux' ูุงูุณุฎ ุงูุฃูุฑ ุงูุฐู ูุธูุฑ ูู"
          echo "๐ ุงูุตู ุงูุฃูุฑ ุงูุฐู ุญุตูุช ุนููู ูู ุงูุณุทุฑ ุงูุชุงูู ุจุนุฏ <PASTE_COMMAND_HERE>"

      - name: ุถุน ููุฏ Google Remote Desktop ููุง
        run: |
          # โ๏ธ ุงูุตู ุฃูุฑ ุงูุชุณุฌูู ููุง ูู ูููุน Google Remote Desktop
          echo "โ ูู ูุชู ูุถุน ุฃูุฑ ุงูุชุณุฌูู ุจุนุฏ"
          echo "๐ ุงูุชุญ https://remotedesktop.google.com/headless ูุณุฌูู ุฏุฎููู ูุงูุณุฎ ุงูุฃูุฑ"

